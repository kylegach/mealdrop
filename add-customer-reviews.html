<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Log: Add Customer Reviews</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
            line-height: 1.6;
            background: #1e1e1e;
            color: #cccccc;
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            background: #1e1e1e;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: #252526;
            color: #cccccc;
            padding: 12px 20px;
            border-bottom: 1px solid #3c3c3c;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header h1 {
            font-size: 13px;
            font-weight: 400;
            color: #cccccc;
        }

        .header-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header p {
            font-size: 12px;
            color: #858585;
        }

        .chat-container {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
        }

        .message {
            margin-bottom: 24px;
            animation: fadeIn 0.2s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            gap: 8px;
        }

        .avatar {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #ffffff;
            font-size: 11px;
            flex-shrink: 0;
        }

        .avatar.user {
            background: #0078d4;
        }

        .avatar.assistant {
            background: #8b5cf6;
        }

        .username {
            font-weight: 600;
            font-size: 13px;
            color: #cccccc;
        }

        .message-content {
            padding-left: 28px;
            color: #cccccc;
            font-size: 13px;
            line-height: 1.6;
        }

        .message.user .message-content {
            color: #d4d4d4;
        }

        .message.assistant .message-content {
            color: #cccccc;
        }

        .tool-invocation {
            margin: 8px 0;
            padding: 8px 12px;
            background: #2d2d30;
            border-left: 2px solid #0078d4;
            border-radius: 3px;
            font-size: 12px;
        }

        .tool-invocation strong {
            color: #4ec9b0;
        }

        code {
            background: #2d2d30;
            color: #d7ba7d;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 12px;
        }

        pre {
            background: #1e1e1e;
            border: 1px solid #3c3c3c;
            color: #d4d4d4;
            padding: 12px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 8px 0;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
        }

        pre code {
            background: none;
            padding: 0;
            color: #d4d4d4;
        }

        .collapsible {
            background: #2d2d30;
            padding: 8px 12px;
            border-radius: 3px;
            margin: 8px 0;
            cursor: pointer;
            user-select: none;
            border: 1px solid #3c3c3c;
        }

        .collapsible:hover {
            background: #37373d;
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapsible-content.open {
            max-height: 2000px;
        }

        .meta-info {
            color: #858585;
            font-size: 12px;
            margin-top: 4px;
            font-style: italic;
        }

        .summary {
            background: #2d2d30;
            border-left: 3px solid #4ec9b0;
            padding: 12px 16px;
            margin: 0 0 20px 0;
            border-radius: 3px;
        }

        .summary h3 {
            color: #4ec9b0;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 600;
        }

        .summary p {
            font-size: 13px;
            line-height: 1.6;
        }

        .footer {
            background: #252526;
            padding: 12px 20px;
            text-align: center;
            color: #858585;
            font-size: 11px;
            border-top: 1px solid #3c3c3c;
            margin-top: auto;
        }

        .footer p {
            margin: 4px 0;
        }

        .badge {
            display: inline-block;
            padding: 2px 6px;
            background: #2d2d30;
            border-radius: 3px;
            font-size: 11px;
            margin-left: 8px;
            color: #858585;
            border: 1px solid #3c3c3c;
        }

        a {
            color: #3794ff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        strong {
            color: #ffffff;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <div class="header-icon">ðŸ’¬</div>
                <h1>Chat: Add Customer Reviews</h1>
            </div>
            <p>Model: claude-sonnet-4.5</p>
        </div>

        <div class="chat-container">
            <div class="summary">
                <h3>Conversation Summary</h3>
                <p>This conversation covers the creation of a CustomerReviews component for the mealdrop project. The component displays multiple customer reviews with avatars, names, star ratings, and review text. The implementation follows the project's component library patterns and includes Storybook stories for documentation.</p>
            </div>

            <div id="messages"></div>
        </div>

        <div class="footer">
            <p>Branch: add-customer-reviews-2 â€¢ Repository: kylegach/mealdrop â€¢ Generated from add-customer-reviews.json</p>
        </div>
    </div>

    <script>
        // Load and parse the JSON file
        async function loadChat() {
            try {
                const response = await fetch('add-customer-reviews.json');
                const data = await response.json();
                renderChat(data);
            } catch (error) {
                console.error('Error loading chat:', error);
                document.getElementById('messages').innerHTML = '<p style="color: red;">Error loading chat data. Please make sure the JSON file is in the same directory.</p>';
            }
        }

        function renderChat(data) {
            const messagesContainer = document.getElementById('messages');
            
            data.requests.forEach((request, index) => {
                // User message
                const userMessage = document.createElement('div');
                userMessage.className = 'message user';
                userMessage.innerHTML = `
                    <div class="message-header">
                        <div class="avatar user">${data.requesterUsername.charAt(0).toUpperCase()}</div>
                        <div class="username">${data.requesterUsername}<span class="badge">User</span></div>
                    </div>
                    <div class="message-content">
                        ${formatText(request.message.text)}
                    </div>
                `;
                messagesContainer.appendChild(userMessage);

                // Assistant response
                if (request.response && request.response.length > 0) {
                    const assistantMessage = document.createElement('div');
                    assistantMessage.className = 'message assistant';
                    
                    let responseContent = '';
                    request.response.forEach(item => {
                        if (item.value) {
                            responseContent += formatText(item.value);
                        } else if (item.kind === 'toolInvocationSerialized') {
                            const toolName = item.invocationMessage?.value || 'Tool execution';
                            responseContent += `
                                <div class="tool-invocation">
                                    <strong>ðŸ”§ ${toolName}</strong>
                                    ${item.originMessage ? `<br><span class="meta-info">${item.originMessage}</span>` : ''}
                                </div>
                            `;
                        } else if (item.kind === 'prepareToolInvocation') {
                            responseContent += `
                                <div class="tool-invocation">
                                    <strong>ðŸ”§ Preparing: ${item.toolName}</strong>
                                </div>
                            `;
                        }
                    });

                    assistantMessage.innerHTML = `
                        <div class="message-header">
                            <div class="avatar assistant">ðŸ¤–</div>
                            <div class="username">${data.responderUsername}<span class="badge">Assistant</span></div>
                        </div>
                        <div class="message-content">
                            ${responseContent}
                        </div>
                    `;
                    messagesContainer.appendChild(assistantMessage);
                }
            });
        }

        function formatText(text) {
            if (!text) return '';
            
            // Convert markdown-style code blocks
            text = text.replace(/```(\w+)?\n([\s\S]*?)```/g, function(match, lang, code) {
                return `<pre><code>${escapeHtml(code.trim())}</code></pre>`;
            });
            
            // Convert inline code
            text = text.replace(/`([^`]+)`/g, '<code>$1</code>');
            
            // Convert bold
            text = text.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
            
            // Convert line breaks
            text = text.replace(/\n/g, '<br>');
            
            return text;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Load chat on page load
        loadChat();
    </script>
</body>
</html>
